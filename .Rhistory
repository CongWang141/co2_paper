panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 3, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 5), breaks = seq(0, 3, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
View(Intensity_scope1)
View(Intensity_scope2)
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1)) +
theme_bw()
View(Intensity_scope1)
ggplot(Intensity_scope1, aes(x=percentiles, y=mean_RET)) +
geom_line()
ggplot(Intensity_scope1, aes(x=percentiles, y=RET_mean)) +
geom_line()
ggplot(Intensity_scope2, aes(x=percentiles, y=RET_mean)) +
geom_line()
ggplot(Intensity_scope3, aes(x=percentiles, y=RET_mean)) +
geom_line()
ggplot(Intensity_tot, aes(x=percentiles, y=RET_mean)) +
geom_line()
# plot
# Create a data frame that combines all four co2 data frames
combined_data_in <- bind_rows(
Intensity_tot %>% mutate(Category = "Panel A: Total CO2 Intensity"),
Intensity_scope1 %>% mutate(Category = "Panel B: Scope1 CO2 Intensity"),
Intensity_scope2 %>% mutate(Category = "Panel C: Scope2 CO2 Intensity"),
Intensity_scope3 %>% mutate(Category = "Panel D: Scope3 CO2 Intensity")
)
View(combined_data_in)
ggplot(Intensity_tot, aes(x=percentiles, y=RET_mean)) +
geom_line()
ggplot(Intensity_scope1, aes(x=percentiles, y=RET_mean)) +
geom_line()
ggplot(Intensity_scope2, aes(x=percentiles, y=RET_mean)) +
geom_line()
ggplot(Intensity_scope3, aes(x=percentiles, y=RET_mean)) +
geom_line()
ggplot(Intensity_scope3, aes(x=percentiles, y=RET_mean)) +
geom_line()
max(Intensity_scope3)
max(Intensity_scope3, rm.na=TRUE)
max(Intensity_scope3, na.rm=TRUE)
max(Intensity_scope3$RET_mean, na.rm=TRUE)
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 7), breaks = seq(0, 7, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1)) +
theme_bw()
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 7), breaks = seq(0, 7, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
max(Intensity_scope3$RET_mean, na.rm=TRUE)
max(Intensity_scope2$RET_mean, na.rm=TRUE)
max(Intensity_scope1$RET_mean, na.rm=TRUE)
max(Intensity_tot$RET_mean, na.rm=TRUE)
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
ggplot(Intensity_scope3, aes(x=percentiles, y=RET_mean)) +
geom_line()
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5))
combined_data_in <- combined_data_in %>%
complete(Category, percentiles, fill = list(RET_mean = NA))
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
ggplot(Intensity_scope3, aes(x=percentiles, y=RET_mean)) +
geom_line()
# Create a ggplot
ggplot(combined_data, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Emissions", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 3), breaks = seq(0, 3, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
library(tidyverse)
library(ggplot2)
# set theme for plotting
theme_set(theme_classic(base_size = 8))
df <- read.csv("data/data.csv")
# Choose time period
df <- df[df$year_month > "2001-12" & df$year_month < "2022-01", ]
# Convert Intensity_tot column to percentiles and create intensity_tot dataframe
Intensity_tot <- df %>%
mutate(percentiles = as.integer(cut(Intensity_tot, breaks = quantile(Intensity_tot, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope1 column to percentiles and create Intensity_scope1 dataframe
Intensity_scope1 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope1, breaks = quantile(Intensity_scope1, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope2 column to percentiles and create Intensity_scope2 dataframe
Intensity_scope2 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope2, breaks = quantile(Intensity_scope2, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope3 column to percentiles and create Intensity_scope3 dataframe
Intensity_scope3 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope3, breaks = quantile(Intensity_scope3, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# plot
# Create a data frame that combines all four co2 data frames
combined_data_in <- bind_rows(
Intensity_tot %>% mutate(Category = "Panel A: Total CO2 Intensity"),
Intensity_scope1 %>% mutate(Category = "Panel B: Scope1 CO2 Intensity"),
Intensity_scope2 %>% mutate(Category = "Panel C: Scope2 CO2 Intensity"),
Intensity_scope3 %>% mutate(Category = "Panel D: Scope3 CO2 Intensity")
)
combined_data_in <- combined_data_in %>%
complete(Category, percentiles, fill = list(RET_mean = NA))
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
# Convert the RET column to percentages (multiply by 100)
df <- df %>% mutate(RET = RET * 100)
# Convert Intensity_tot column to percentiles and create intensity_tot dataframe
Intensity_tot <- df %>%
mutate(percentiles = as.integer(cut(Intensity_tot, breaks = quantile(Intensity_tot, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope1 column to percentiles and create Intensity_scope1 dataframe
Intensity_scope1 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope1, breaks = quantile(Intensity_scope1, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope2 column to percentiles and create Intensity_scope2 dataframe
Intensity_scope2 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope2, breaks = quantile(Intensity_scope2, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope3 column to percentiles and create Intensity_scope3 dataframe
Intensity_scope3 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope3, breaks = quantile(Intensity_scope3, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# plot
# Create a data frame that combines all four co2 data frames
combined_data_in <- bind_rows(
Intensity_tot %>% mutate(Category = "Panel A: Total CO2 Intensity"),
Intensity_scope1 %>% mutate(Category = "Panel B: Scope1 CO2 Intensity"),
Intensity_scope2 %>% mutate(Category = "Panel C: Scope2 CO2 Intensity"),
Intensity_scope3 %>% mutate(Category = "Panel D: Scope3 CO2 Intensity")
)
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
combined_data_in <- na.omit(combined_data_in)
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
is.na(combined_data_in)
sum(is.na(combined_data_in))
# plot
# Create a data frame that combines all four co2 data frames
combined_data_in <- bind_rows(
Intensity_tot %>% mutate(Category = "Panel A: Total CO2 Intensity"),
Intensity_scope1 %>% mutate(Category = "Panel B: Scope1 CO2 Intensity"),
Intensity_scope2 %>% mutate(Category = "Panel C: Scope2 CO2 Intensity"),
Intensity_scope3 %>% mutate(Category = "Panel D: Scope3 CO2 Intensity")
)
sum(is.na(combined_data_in))
combined_data_in <- na.omit(combined_data_in)
sum(is.na(combined_data_in))
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
View(combined_data_in)
# Create a ggplot
ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(-1, 4), breaks = seq(-1, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
# Convert Co2_tot column to percentiles and create co2_tot dataframe
co2_tot <- df %>%
mutate(
percentiles = as.integer(cut(Co2_tot, breaks = quantile(Co2_tot, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))
) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Co2_scope1 column to percentiles and create co2_scope1 dataframe
co2_scope1 <- df %>%
mutate(
percentiles = as.integer(cut(Co2_scope1, breaks = quantile(Co2_scope1, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))
) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Co2_scope2 column to percentiles and create co2_scope2 dataframe
co2_scope2 <- df %>%
mutate(
percentiles = as.integer(cut(Co2_scope2, breaks = quantile(Co2_scope2, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))
) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Co2_scope3 column to percentiles and create co2_scope3 dataframe
co2_scope3 <- df %>%
mutate(
percentiles = as.integer(cut(Co2_scope3, breaks = quantile(Co2_scope3, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))
) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# plot
# Create a data frame that combines all four co2 data frames
combined_data <- bind_rows(
co2_tot %>% mutate(Category = "Panel A: Total CO2 Emissions"),
co2_scope1 %>% mutate(Category = "Panel B: Scope1 CO2 Emissions"),
co2_scope2 %>% mutate(Category = "Panel C: Scope2 CO2 Emissions"),
co2_scope3 %>% mutate(Category = "Panel D: Scope3 CO2 Emissions")
)
# Create a ggplot
co2_percentile <- ggplot(combined_data, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Emissions", y = "Average Stock Returns") +
scale_y_continuous(limits = c(0, 3), breaks = seq(0, 3, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
print(co2_percentile)
# save graphics
ggsave(filename = "graph/co2_percentile.png",
plot = co2_percentile,
width = 5.5, height = 3.1,
dpi = 500, bg = "white")
# Convert Intensity_tot column to percentiles and create intensity_tot dataframe
Intensity_tot <- df %>%
mutate(percentiles = as.integer(cut(Intensity_tot, breaks = quantile(Intensity_tot, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope1 column to percentiles and create Intensity_scope1 dataframe
Intensity_scope1 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope1, breaks = quantile(Intensity_scope1, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope2 column to percentiles and create Intensity_scope2 dataframe
Intensity_scope2 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope2, breaks = quantile(Intensity_scope2, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Intensity_scope3 column to percentiles and create Intensity_scope3 dataframe
Intensity_scope3 <- df %>%
mutate(percentiles = as.integer(cut(Intensity_scope3, breaks = quantile(Intensity_scope3, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# plot
# Create a data frame that combines all four co2 data frames
combined_data_in <- bind_rows(
Intensity_tot %>% mutate(Category = "Panel A: Total CO2 Intensity"),
Intensity_scope1 %>% mutate(Category = "Panel B: Scope1 CO2 Intensity"),
Intensity_scope2 %>% mutate(Category = "Panel C: Scope2 CO2 Intensity"),
Intensity_scope3 %>% mutate(Category = "Panel D: Scope3 CO2 Intensity")
)
# Create a ggplot
intensity_percentile <- ggplot(combined_data_in, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On CO2 Intensity", y = "Average Stock Returns") +
scale_y_continuous(limits = c(-1, 4), breaks = seq(-1, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
# save graphics
ggsave(filename = "graph/intensity_percentile.png",
plot = intensity_percentile,
width = 5.5, height = 3.1,
dpi = 500, bg = "white")
library(tidyverse)
library(ggplot2)
# set theme for plotting
theme_set(theme_classic(base_size = 8))
df <- read.csv("data/data.csv")
# Choose time period
df <- df[df$year_month > "2001-12" & df$year_month < "2022-01", ]
# Convert Marketcap column to percentiles and create Marketcap dataframe
Marketcap <- df %>%
mutate(percentiles = as.integer(cut(Marketcap, breaks = quantile(Marketcap, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Leverage column to percentiles and create Leverage dataframe
Leverage <- df %>%
mutate(percentiles = as.integer(cut(Leverage, breaks = quantile(Leverage, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert RoE column to percentiles and create RoE dataframe
RoE <- df %>%
mutate(percentiles = as.integer(cut(RoE, breaks = quantile(RoE, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert SaleGR column to percentiles and create SaleGR dataframe
SaleGR <- df %>%
mutate(percentiles = as.integer(cut(SaleGR, breaks = quantile(SaleGR, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# plot
# Create a data frame that combines all four co2 data frames
combined_data_others <- bind_rows(
Marketcap %>% mutate(Category = "Panel A: Firm Size"),
Leverage %>% mutate(Category = "Panel B: Leverage"),
RoE %>% mutate(Category = "Panel C: RoE"),
SaleGR %>% mutate(Category = "Panel D: Sales Growth")
)
# Create a ggplot
others_percentile <- ggplot(combined_data_others, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On Other Characteristics", y = "Average Stock Returns") +
scale_y_continuous(limits = c(-1, 4), breaks = seq(-1, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
print(others_percentile)
# Create a ggplot
others_percentile <- ggplot(combined_data_others, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On Other Characteristics", y = "Average Stock Returns") +
scale_y_continuous(limits = c(-1, 4), breaks = seq(-1, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
# Convert Marketcap column to percentiles and create Marketcap dataframe
Marketcap <- df %>%
mutate(percentiles = as.integer(cut(Marketcap, breaks = quantile(Marketcap, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Leverage column to percentiles and create Leverage dataframe
Levarage <- df %>%
mutate(percentiles = as.integer(cut(Levarage, breaks = quantile(Levarage, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert RoE column to percentiles and create RoE dataframe
RoE <- df %>%
mutate(percentiles = as.integer(cut(RoE, breaks = quantile(RoE, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert SaleGR column to percentiles and create SaleGR dataframe
SaleGR <- df %>%
mutate(percentiles = as.integer(cut(SaleGR, breaks = quantile(SaleGR, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# plot
# Create a data frame that combines all four co2 data frames
combined_data_others <- bind_rows(
Marketcap %>% mutate(Category = "Panel A: Firm Size"),
Leverage %>% mutate(Category = "Panel B: Leverage"),
RoE %>% mutate(Category = "Panel C: RoE"),
SaleGR %>% mutate(Category = "Panel D: Sales Growth")
)
# plot
# Create a data frame that combines all four co2 data frames
combined_data_others <- bind_rows(
Marketcap %>% mutate(Category = "Panel A: Firm Size"),
Levarage %>% mutate(Category = "Panel B: Leverage"),
RoE %>% mutate(Category = "Panel C: RoE"),
SaleGR %>% mutate(Category = "Panel D: Sales Growth")
)
# Create a ggplot
others_percentile <- ggplot(combined_data_others, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On Other Characteristics", y = "Average Stock Returns") +
scale_y_continuous(limits = c(-1, 4), breaks = seq(-1, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
print(others_percentile)
# Convert the RET column to percentages (multiply by 100)
df <- df %>% mutate(RET = RET * 100)
# Convert Co2_tot column to percentiles and create co2_tot dataframe
co2_tot <- df %>%
mutate(
percentiles = as.integer(cut(Co2_tot, breaks = quantile(Co2_tot, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))
) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Co2_scope1 column to percentiles and create co2_scope1 dataframe
co2_scope1 <- df %>%
mutate(
percentiles = as.integer(cut(Co2_scope1, breaks = quantile(Co2_scope1, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))
) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Marketcap column to percentiles and create Marketcap dataframe
Marketcap <- df %>%
mutate(percentiles = as.integer(cut(Marketcap, breaks = quantile(Marketcap, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert Leverage column to percentiles and create Leverage dataframe
Levarage <- df %>%
mutate(percentiles = as.integer(cut(Levarage, breaks = quantile(Levarage, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert RoE column to percentiles and create RoE dataframe
RoE <- df %>%
mutate(percentiles = as.integer(cut(RoE, breaks = quantile(RoE, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# Convert SaleGR column to percentiles and create SaleGR dataframe
SaleGR <- df %>%
mutate(percentiles = as.integer(cut(SaleGR, breaks = quantile(SaleGR, probs = seq(0, 1, by = 0.01), na.rm = TRUE), labels = FALSE))) %>%
group_by(percentiles) %>%
summarize(RET_mean = mean(RET, na.rm = TRUE))
# plot
# Create a data frame that combines all four co2 data frames
combined_data_others <- bind_rows(
Marketcap %>% mutate(Category = "Panel A: Firm Size"),
Levarage %>% mutate(Category = "Panel B: Leverage"),
RoE %>% mutate(Category = "Panel C: RoE"),
SaleGR %>% mutate(Category = "Panel D: Sales Growth")
)
# Create a ggplot
others_percentile <- ggplot(combined_data_others, aes(x = percentiles, y = RET_mean, color = Category)) +
geom_line() +
facet_wrap(~ Category, nrow = 2, scales = "free") +
labs(x = "Percentiles Based On Other Characteristics", y = "Average Stock Returns") +
scale_y_continuous(limits = c(-1, 4), breaks = seq(-1, 4, by = 0.5)) +
theme(legend.position = "none",
panel.grid.major = element_line(color = "gray", linetype = "dashed", linewidth = 0.2),
panel.grid.minor = element_line(color = "lightgray", linetype = "dotted", linewidth = 0.1))
print(others_percentile)
# save graphics
ggsave(filename = "graph/others_percentile.png",
plot = others_percentile,
width = 5.5, height = 3.1,
dpi = 500, bg = "white")
